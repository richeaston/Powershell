clear
$array = @("1001","1004")
$i =  0
$count = 0

Do {
        write-host "processing `"HKLM:\\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\$i`"" -ForegroundColor Yellow
        $path = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\$i"
        foreach ($a in $array) {
            try {
                $lsa = Get-Itemproperty -path $path  -NAME $a -ErrorAction ignore
                if ($LSA) {
                    $secure = Get-ItemPropertyValue -Path $path -Name $a
                    if ($secure -eq "3") {
                        Write-Output "$a All Good, set to $secure"
                        Exit 0
                    } else {
                        Write-warning "$a needs remediation, setting $secure"
                        Exit 1
                    }
                } else {
                    $errMsg = $_.Exception.Message
                    Write-warning "$a needs remediation, item does not exist"
                    Exit 1
                }
                
                $count++
            }
            Catch {
                $errMsg = $_.Exception.Message
                write-output "Registry Entry does not exist!"
                Exit 1
            }
        }            
        $i++
} until ( $count -gt 6)
