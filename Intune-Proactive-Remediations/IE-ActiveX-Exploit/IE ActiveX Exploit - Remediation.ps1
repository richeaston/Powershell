clear
$array = @("1001","1004")
$i =  0
$count = 0

Do {
        write-host "processing `"HKLM:\\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\$i`"" -ForegroundColor Yellow
        $path = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\CurrentVersion\Internet Settings\Zones\$i"
        foreach ($a in $array) {
            try {
                $lsa = Get-Itemproperty -path $path  -NAME $a -ErrorAction ignore
                if ($LSA) {
                    $secure = Get-ItemPropertyValue -Path $path -Name $a
                    if ($secure -ne "3") {
                        Set-ItemProperty -Path $path -Name $a -value 3 -Force
                        Write-Output "$a All Good, now set to $secure"
                    }
                } else {
                     Write-output "Creating Registry item $a" 
                     New-ItemProperty -Path $path -Name $a -PropertyType DWORD -value 3 -Force -verbose
                }
                Exit 0
                $count++
            }
            Catch {
                $errMsg = $_.Exception.Message
                write-output "Registry Entry does not exist!"
                Exit 1
            }
        }            
        $i++
} until ( $count -gt 6)




